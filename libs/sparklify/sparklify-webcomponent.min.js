function o(n,t){return Math.random()*(t-n)+n}function l(n){let t=/^([\d.]+)([a-z%]+)$/i,e=n.match(t);if(!e)throw new Error(`Invalid CSS size: ${n}`);return{value:parseFloat(e[1]),unit:e[2]}}var c="M26.5 25.5C19.0043 33.3697 0 34 0 34C0 34 19.1013 35.3684 26.5 43.5C33.234 50.901 34 68 34 68C34 68 36.9884 50.7065 44.5 43.5C51.6431 36.647 68 34 68 34C68 34 51.6947 32.0939 44.5 25.5C36.5605 18.2235 34 0 34 0C34 0 33.6591 17.9837 26.5 25.5Z",h=class{#t=document.createElement("div");size;color;constructor(t,e){this.size=t,this.color=e,this.#e()}#e(){this.#t.classList.add("sparklify-sparkleWrapper"),this.#t.style.width=this.size;let t=document.createElement("div");t.classList.add("sparklify-outerSparkle"),t.style.width=this.size;let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("viewBox","0 0 68 68"),e.innerHTML=`<path d="${c}" fill="${this.color}"/>`,e.classList.add("sparklify-innerSparkle"),e.style.width=this.size,t.appendChild(e),this.#t.appendChild(t)}getDomRef(){return this.#t}destroy(){this.#t.remove()}};var d=class{target;size;colors;animationLength;initialDelay;pauseMin;pauseMax;animationLengthMin;animationLengthMax;isRunning=!1;isPaused=!1;animationController=new AbortController;resolveAfterStop=void 0;constructor(t){this.target=t.target,this.size=t.size??"1.2rem",this.colors=t.colors??["yellow","white","gold","orange"],this.animationLength=t.animationLength??700,this.initialDelay=t.initialDelay??0,this.pauseMin=t.pauseMin??100,this.pauseMax=t.pauseMax??500,this.animationLengthMin=this.animationLength,this.animationLengthMax=this.animationLength*1.6}wait(t,e){return new Promise((i,s)=>{let a=setTimeout(i,t);e&&e.addEventListener("abort",()=>{clearTimeout(a),s(new DOMException("Aborted","AbortError"))})})}async runSparkle(t){let e=this.colors[Math.floor(Math.random()*this.colors.length)],i=new h(this.size,e),s=i.getDomRef();s.style.top=Math.random()*100+"%",s.style.left=Math.random()*100+"%",s.style.setProperty("--animation-length",`${t}ms`),Math.random()<.3?s.style.zIndex="-1":s.style.zIndex="2",this.animationController.signal.addEventListener("abort",()=>{i.destroy()}),this.target.insertAdjacentElement("afterbegin",s);try{await this.wait(t,this.animationController.signal)}catch{}i.destroy()}async animate(){this.isPaused=!0;try{await this.wait(this.initialDelay,this.animationController.signal)}catch{return}for(this.isPaused=!1;this.isRunning;){let t=o(this.animationLengthMin,this.animationLengthMax);if(await this.runSparkle(t),this.resolveAfterStop&&this.resolveAfterStop(null),!this.isRunning)break;this.isPaused=!0;let e=o(this.pauseMin,this.pauseMax);try{await this.wait(e,this.animationController.signal)}catch{break}this.isPaused=!1}}start(){this.isRunning||(this.isRunning=!0,this.animationController.signal.addEventListener("abort",()=>{this.isRunning=!1}),this.animate())}stop(){this.animationController.abort(),this.animationController=new AbortController}async stopOnceDone(){if(!this.isRunning||this.isPaused){this.stop();return}let t=Promise.withResolvers();this.resolveAfterStop=t.resolve,await t.promise,this.resolveAfterStop=void 0,this.stop()}};var p=class{count=3;colors=["yellow","white","gold","orange"];size="1.2rem";speed=1e3;target=null;initialized=!1;animations=[];isUpdating=!1;pendingUpdate=!1;setCount(t){this.count=t,this.scheduleUpdate()}setColors(t){this.colors=t,this.scheduleUpdate()}setSize(t){this.size=t,this.scheduleUpdate()}setSpeed(t){this.speed=t,this.scheduleUpdate()}scheduleUpdate(){if(this.initialized){if(this.isUpdating){this.pendingUpdate=!0;return}this.updateAnimations()}}async updateAnimations(t=!1){if(!this.target)return;this.isUpdating=!0,this.pendingUpdate=!1,t||(await Promise.all(this.animations.map(async s=>{await s.stopOnceDone()})),this.animations=[]);let e=0,i=l(this.size);for(let s=0;s<this.count;s++){let a=o(.5,1),r=new d({target:this.target,size:`${i.value*a}${i.unit}`,colors:this.colors,animationLength:this.speed*a,initialDelay:e});r.start(),this.animations.push(r),e+=o(100,300)}this.isUpdating=!1,this.pendingUpdate&&await this.updateAnimations()}async init(t){this.target=t,this.initialized=!0,await this.updateAnimations(!0)}destroy(){this.animations.forEach(t=>t.stop()),this.animations=[],this.target=null}};var m=document.createElement("template");m.innerHTML=`<style>.sparklify-target {
  position: relative;
  display: inline-block;
}

@keyframes sparklify-rotate-sparkle {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(180deg);
  }
}

@keyframes sparklify-scale-sparkle {
  0% {
    transform: scale(0);
  }
  50% {
    transform: scale(1);
  }
  100% {
    transform: scale(0);
  }
}

.sparklify-sparkleWrapper,
.sparklify-sparkleWrapper * {
  pointer-events: none;
}

.sparklify-sparkleWrapper {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;

  --animation-length: 600ms;

  transform: translate(-50%, -50%);
}

.sparklify-outerSparkle {
  display: flex;
  align-items: center;
  justify-content: center;
  animation: sparklify-scale-sparkle var(--animation-length) ease-in-out
    forwards;
}

.sparklify-innerSparkle {
  animation: sparklify-rotate-sparkle var(--animation-length) linear forwards;
}
</style>`;var u=class extends HTMLElement{handler=new p;static get observedAttributes(){return["count","colors","size","speed"]}connectedCallback(){let t=this.attachShadow({mode:"open"}),e=m.content.cloneNode(!0);t.appendChild(e);let i=document.createElement("style");t.appendChild(i),i.sheet?.insertRule(`
      :host {
        display: inline-block;
      }
    `);let s=document.createElement("slot");s.addEventListener("slotchange",()=>{this.handler.updateAnimations()});let a=document.createElement("div");a.style.position="relative",a.appendChild(s),t.appendChild(a);let r={count:parseInt(this.getAttribute("count")||"0",10)||3,colors:this.getAttribute("colors")?.split(",")||["yellow","white","gold","orange"],size:this.getAttribute("size")||"20px",speed:parseInt(this.getAttribute("speed")||"0",10)||1e3};this.handler.setCount(r.count),this.handler.setColors(r.colors),this.handler.setSize(r.size),this.handler.setSpeed(r.speed),this.handler.init(a)}disconnectedCallback(){this.handler.destroy()}attributeChangedCallback(t,e,i){if(!(i==null||e===i))switch(t){case"count":this.setCount(parseInt(i,10));break;case"colors":this.setColors(i.split(","));break;case"size":try{l(i)}catch(s){console.error(s);return}this.setSize(i);break;case"speed":this.setSpeed(parseInt(i,10));break;default:throw new Error(`The property ${t} is not supported`)}}setCount(t){this.handler.setCount(t),this.setAttribute("count",t.toString())}setColors(t){this.handler.setColors(t),this.setAttribute("colors",t.join(","))}setSize(t){this.handler.setSize(t),this.setAttribute("size",t)}setSpeed(t){this.handler.setSpeed(t),this.setAttribute("speed",t.toString())}};window.customElements.define("sparklify-content",u);
//# sourceMappingURL=sparklify-webcomponent.min.js.map
