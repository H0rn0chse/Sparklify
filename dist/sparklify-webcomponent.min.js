function r(n,t){return Math.random()*(t-n)+n}function o(n){let t=/^([\d.]+)([a-z%]+)$/i,e=n.match(t);if(!e)throw new Error(`Invalid CSS size: ${n}`);return{value:parseFloat(e[1]),unit:e[2]}}var c="M26.5 25.5C19.0043 33.3697 0 34 0 34C0 34 19.1013 35.3684 26.5 43.5C33.234 50.901 34 68 34 68C34 68 36.9884 50.7065 44.5 43.5C51.6431 36.647 68 34 68 34C68 34 51.6947 32.0939 44.5 25.5C36.5605 18.2235 34 0 34 0C34 0 33.6591 17.9837 26.5 25.5Z",l=class{#t=document.createElement("div");size;color;constructor(t,e){this.size=t,this.color=e,this.#e()}#e(){this.#t.classList.add("sparkleWrapper"),this.#t.style.width=this.size;let t=document.createElement("div");t.classList.add("outerSparkle"),t.style.width=this.size;let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("viewBox","0 0 68 68"),e.innerHTML=`<path d="${c}" fill="${this.color}"/>`,e.classList.add("innerSparkle"),e.style.width=this.size,t.appendChild(e),this.#t.appendChild(t)}getDomRef(){return this.#t}destroy(){this.#t.remove()}};var h=class{target;size;colors;animationLength;initialDelay;pauseMin;pauseMax;animationLengthMin;animationLengthMax;isRunning=!1;isPaused=!1;animationController=new AbortController;resolveAfterStop=void 0;constructor(t){this.target=t.target,this.size=t.size??"1.2rem",this.colors=t.colors??["yellow","white","gold","orange"],this.animationLength=t.animationLength??700,this.initialDelay=t.initialDelay??0,this.pauseMin=t.pauseMin??100,this.pauseMax=t.pauseMax??500,this.animationLengthMin=this.animationLength,this.animationLengthMax=this.animationLength*1.6}wait(t,e){return new Promise((s,i)=>{let a=setTimeout(s,t);e&&e.addEventListener("abort",()=>{clearTimeout(a),i(new DOMException("Aborted","AbortError"))})})}async runSparkle(t){let e=this.colors[Math.floor(Math.random()*this.colors.length)],s=new l(this.size,e),i=s.getDomRef();i.style.top=Math.random()*100+"%",i.style.left=Math.random()*100+"%",i.style.setProperty("--animation-length",`${t}ms`),Math.random()<.3?i.style.zIndex="-1":i.style.zIndex="2",this.animationController.signal.addEventListener("abort",()=>{s.destroy()}),this.target.insertAdjacentElement("afterbegin",i);try{await this.wait(t,this.animationController.signal)}catch{}s.destroy()}async animate(){this.isPaused=!0;try{await this.wait(this.initialDelay,this.animationController.signal)}catch{return}for(this.isPaused=!1;this.isRunning;){let t=r(this.animationLengthMin,this.animationLengthMax);if(await this.runSparkle(t),this.resolveAfterStop&&this.resolveAfterStop(null),!this.isRunning)break;this.isPaused=!0;let e=r(this.pauseMin,this.pauseMax);try{await this.wait(e,this.animationController.signal)}catch{break}this.isPaused=!1}}start(){this.isRunning||(this.isRunning=!0,this.animationController.signal.addEventListener("abort",()=>{this.isRunning=!1}),this.animate())}stop(){this.animationController.abort(),this.animationController=new AbortController}async stopOnceDone(){if(!this.isRunning||this.isPaused){this.stop();return}let t=Promise.withResolvers();this.resolveAfterStop=t.resolve,await t.promise,this.resolveAfterStop=void 0,this.stop()}};var d=class{count=3;colors=["yellow","white","gold","orange"];size="1.2rem";speed=1e3;target=null;initialized=!1;animations=[];isUpdating=!1;pendingUpdate=!1;setCount(t){this.count=t,this.scheduleUpdate()}setColors(t){this.colors=t,this.scheduleUpdate()}setSize(t){this.size=t,this.scheduleUpdate()}setSpeed(t){this.speed=t,this.scheduleUpdate()}scheduleUpdate(){if(this.initialized){if(this.isUpdating){this.pendingUpdate=!0;return}this.updateAnimations()}}async updateAnimations(t=!1){if(!this.target)return;this.isUpdating=!0,this.pendingUpdate=!1,t||(await Promise.all(this.animations.map(async i=>{await i.stopOnceDone()})),this.animations=[]);let e=0,s=o(this.size);for(let i=0;i<this.count;i++){let a=r(.5,1),u=new h({target:this.target,size:`${s.value*a}${s.unit}`,colors:this.colors,animationLength:this.speed*a,initialDelay:e});u.start(),this.animations.push(u),e+=r(100,300)}this.isUpdating=!1,this.pendingUpdate&&await this.updateAnimations()}async init(t){this.target=t,this.initialized=!0,await this.updateAnimations(!0)}destroy(){this.animations.forEach(t=>t.stop()),this.animations=[],this.target=null}};var m=document.createElement("template");m.innerHTML=`<style>@keyframes sparkle-rotate {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(180deg);
  }
}

@keyframes sparkle-size {
  0% {
    transform: scale(0);
  }
  50% {
    transform: scale(1);
  }
  100% {
    transform: scale(0);
  }
}

.sparkleWrapper,
.sparkleWrapper * {
  pointer-events: none;
}

.sparkleWrapper {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;

  --animation-length: 600ms;

  transform: translate(-50%, -50%);
}

.outerSparkle {
  display: flex;
  align-items: center;
  justify-content: center;
  animation: sparkle-size var(--animation-length) ease-in-out forwards;
}

.innerSparkle {
  animation: sparkle-rotate var(--animation-length) linear forwards;
}
</style>`;var p=class extends HTMLElement{handler=new d;static get observedAttributes(){return["count","colors","size","speed"]}connectedCallback(){let t=this.attachShadow({mode:"open"}),e=m.content.cloneNode(!0);t.appendChild(e);let s=document.createElement("slot");s.addEventListener("slotchange",()=>{this.handler.updateAnimations()});let i=document.createElement("div");i.style.position="relative",i.appendChild(s),t.appendChild(i);let a={count:parseInt(this.getAttribute("count")||"0",10)||3,colors:this.getAttribute("colors")?.split(",")||["yellow","white","gold","orange"],size:this.getAttribute("size")||"20px",speed:parseInt(this.getAttribute("speed")||"0",10)||1e3};this.handler.setCount(a.count),this.handler.setColors(a.colors),this.handler.setSize(a.size),this.handler.setSpeed(a.speed),this.handler.init(i)}disconnectedCallback(){this.handler.destroy()}attributeChangedCallback(t,e,s){if(!(s==null||e===s))switch(t){case"count":this.setCount(parseInt(s,10));break;case"colors":this.setColors(s.split(","));break;case"size":try{o(s)}catch(i){console.error(i);return}this.setSize(s);break;case"speed":this.setSpeed(parseInt(s,10));break;default:throw new Error(`The property ${t} is not supported`)}}setCount(t){this.handler.setCount(t),this.setAttribute("count",t.toString())}setColors(t){this.handler.setColors(t),this.setAttribute("colors",t.join(","))}setSize(t){this.handler.setSize(t),this.setAttribute("size",t)}setSpeed(t){this.handler.setSpeed(t),this.setAttribute("speed",t.toString())}};window.customElements.define("sparklify-content",p);
//# sourceMappingURL=sparklify-webcomponent.min.js.map
