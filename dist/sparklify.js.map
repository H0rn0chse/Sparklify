{
  "version": 3,
  "sources": ["../src/Sparkle.ts", "../src/utils.ts", "../src/SparkleAnimation.ts"],
  "sourcesContent": ["// Sparkles from https://www.joshwcomeau.com/react/animated-sparkles-in-react/\nconst path =\n  \"M26.5 25.5C19.0043 33.3697 0 34 0 34C0 34 19.1013 35.3684 26.5 43.5C33.234 50.901 34 68 34 68C34 68 36.9884 50.7065 44.5 43.5C51.6431 36.647 68 34 68 34C68 34 51.6947 32.0939 44.5 25.5C36.5605 18.2235 34 0 34 0C34 0 33.6591 17.9837 26.5 25.5Z\";\n\nexport class Sparkle {\n  #root: HTMLDivElement = document.createElement(\"div\");\n  size: string;\n  color: string;\n\n  constructor(size: string, color: string) {\n    this.size = size;\n    this.color = color;\n\n    this.#createHtml();\n  }\n\n  #createHtml(): void {\n    this.#root.classList.add(\"sparkleWrapper\");\n    this.#root.style.width = this.size;\n\n    const outerSparkle = document.createElement(\"div\");\n    outerSparkle.classList.add(\"outerSparkle\");\n    outerSparkle.style.width = this.size;\n\n    const innerSparkle = document.createElementNS(\n      \"http://www.w3.org/2000/svg\",\n      \"svg\"\n    );\n    innerSparkle.setAttribute(\"viewBox\", \"0 0 68 68\");\n    innerSparkle.innerHTML = `<path d=\"${path}\" fill=\"${this.color}\"/>`;\n    innerSparkle.classList.add(\"innerSparkle\");\n    innerSparkle.style.width = this.size;\n\n    outerSparkle.appendChild(innerSparkle);\n    this.#root.appendChild(outerSparkle);\n  }\n\n  getDomRef(): HTMLDivElement {\n    return this.#root;\n  }\n\n  destroy(): void {\n    this.#root.remove();\n  }\n}\n", "export function randomMinMax (min: number, max: number): number {\n  return Math.random() * (max - min) + min;\n}\n\nexport function parseCssSize(size: string): { value: number; unit: string } {\n  const regex = /^([\\d.]+)([a-z%]+)$/i;\n  const match = size.match(regex);\n  if (!match) {\n    throw new Error(`Invalid CSS size: ${size}`);\n  }\n\n  return {\n    value: parseFloat(match[1]),\n    unit: match[2],\n  };\n} \n", "import { Sparkle } from \"./Sparkle\";\nimport { randomMinMax } from \"./utils\";\n\nexport interface SparkleAnimationOptions {\n  target: HTMLElement;\n  size?: string;\n  colors?: string[];\n  animationLength?: number;\n  initialDelay?: number;\n  pauseMin?: number;\n  pauseMax?: number;\n}\n\nexport class SparkleAnimation {\n  private target: HTMLElement;\n  private size: string;\n  private colors: string[];\n  private animationLength: number;\n  private initialDelay: number;\n  private pauseMin: number;\n  private pauseMax: number;\n  private animationLengthMin: number;\n  private animationLengthMax: number;\n  private isRunning: boolean = false;\n  private isPaused: boolean = false;\n  private animationController: AbortController = new AbortController();\n  private resolveAfterStop: ((value: unknown) => void) | undefined = undefined;\n\n  constructor(options: SparkleAnimationOptions) {\n    this.target = options.target;\n    this.size = options.size ?? \"1.2rem\";\n    this.colors = options.colors ?? [\"yellow\", \"white\", \"gold\", \"orange\"];\n    this.animationLength = options.animationLength ?? 700;\n    this.initialDelay = options.initialDelay ?? 0;\n    this.pauseMin = options.pauseMin ?? 100;\n    this.pauseMax = options.pauseMax ?? 500;\n    this.animationLengthMin = this.animationLength;\n    this.animationLengthMax = this.animationLength * 1.6;\n  }\n\n  private wait(ms: number, signal?: AbortSignal): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(resolve, ms);\n      if (signal) {\n        signal.addEventListener(\"abort\", () => {\n          clearTimeout(timeout);\n          reject(new DOMException(\"Aborted\", \"AbortError\"));\n        });\n      }\n    });\n  }\n\n  private async runSparkle(animationLength: number): Promise<void> {\n      const color = this.colors[Math.floor(Math.random() * this.colors.length)];\n      const sparkle = new Sparkle(this.size, color);\n\n      const domRef = sparkle.getDomRef();\n      domRef.style.top = Math.random() * 100 + \"%\";\n      domRef.style.left = Math.random() * 100 + \"%\";\n      domRef.style.setProperty(\"--animation-length\", `${animationLength}ms`);\n      \n      if (Math.random() < 0.3) { // 30% chance to render behind content\n        domRef.style.zIndex = \"-1\";\n      } else {\n        domRef.style.zIndex = \"2\";\n      }\n\n      // handle abort\n      this.animationController.signal.addEventListener(\"abort\", () => {\n        sparkle.destroy();\n      });\n\n      this.target.insertAdjacentElement(\"afterbegin\", domRef);\n\n      try {\n        await this.wait(animationLength, this.animationController.signal);\n      } catch {}\n      sparkle.destroy();\n  }\n\n  private async animate(): Promise<void> {\n    this.isPaused = true;\n    try {\n      await this.wait(this.initialDelay, this.animationController.signal);\n    } catch {\n      return;\n    }\n    this.isPaused = false;\n\n    while (this.isRunning) {\n      const randomAnimationLength = randomMinMax(this.animationLengthMin, this.animationLengthMax);\n      await this.runSparkle(randomAnimationLength);\n      \n      if (this.resolveAfterStop) {\n        this.resolveAfterStop(null);\n      }\n\n      if (!this.isRunning) {\n        break;\n      };\n      \n      this.isPaused = true;\n      const pauseDuration = randomMinMax(this.pauseMin, this.pauseMax);\n      try {\n        await this.wait(pauseDuration, this.animationController.signal);\n      } catch {\n        break;\n      }\n      this.isPaused = false;\n    }\n  }\n\n  start(): void {\n    if (this.isRunning) {\n      return;\n    }\n    this.isRunning = true;\n\n    this.animationController.signal.addEventListener(\"abort\", () => {\n      this.isRunning = false;\n    });\n\n    this.animate();\n  }\n\n  stop(): void {\n    this.animationController.abort();\n    this.animationController = new AbortController();\n  }\n\n  async stopOnceDone(): Promise<void> {\n    if (!this.isRunning || this.isPaused) {\n      this.stop();\n      return;\n    }\n\n    const stopOnceDoneDeferred = Promise.withResolvers();\n    this.resolveAfterStop = stopOnceDoneDeferred.resolve;\n    await stopOnceDoneDeferred.promise;\n    this.resolveAfterStop = undefined;\n    this.stop();\n  }\n}"],
  "mappings": "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",
  "names": []
}
